[
  {
    "objectID": "posts/welcome/index.html",
    "href": "posts/welcome/index.html",
    "title": "Welcome To My Blog",
    "section": "",
    "text": "This is the first post in a Quarto blog. Welcome!\n\nSince this post doesn’t specify an explicit image, the first image in the post will be used in the listing page of posts.\n\n\n\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "posts/haunted-water/index.html",
    "href": "posts/haunted-water/index.html",
    "title": "Three ways to find out if your water is haunted…",
    "section": "",
    "text": "Total organic carbon (TOC) is a bulk measurement that indicates the amount of organic matter in a water. However, properties of organic matter can vary widely. You may have heard terms like “humic” or “fulvic” fractions to describe different types of TOC. There are several analytical methods that can help uncover different TOC properties, such as fluorescence or size fractionation. But for most water treatment plants, we’re concerned about two main questions: TOC removal and disinfection byproduct (DBP) formation. Using historical data directly can be challenging because there are many water quality and operational parameters that impact how well TOC is removed and how much DBPs will form. Luckily, we have empirical models that can help understand plant performance and correct for these factors.\nThis description assumes you already have a basic knowledge of tidywater. If you don’t know how to create a water or how to connect functions togethers, start with the “getting started” vignette.\nWe’ll start by looking at these functions for one condition. We’ll begin by defining a water that has all the parameters we need for modeling.\n\nstart_water &lt;- define_water(ph = 7.4, temp = 12, alk = 80, tds = 100,\n                          toc = 3, doc = 2.8, uv254 = .1, br = 50)\n\nsummarize_wq(start_water, params = c(\"general\"))\n\n\n\n\n\n\n\n\nGeneral water quality parameters\nResult\nUnits\n\n\n\n\npH\n7.40\n-\n\n\nTemp\n12.00\ndeg C\n\n\nAlkalinity\n80.00\nmg/L as CaCO3\n\n\nTotal_Hardness\nNA\nmg/L as CaCO3\n\n\nTDS\n100.00\nmg/L\n\n\nConductivity\n156.25\nuS/cm\n\n\nTOC\n3.00\nmg/L\n\n\n\n\n\n\n\n\n\nThe two functions we’ll be using today are:\n\nchemdose_toc, which predicts the TOC removal from coagulation using the Edwards (1997) model.\nchemdose_dbp, which predicts the DBP formation from disinfection using the Amy model.\n\nWe also use chemdose_ph to account for pH changes from chemical addition. Often, we don’t need this function when we’re dealing with historical data because we have real measured pH at different points in the treatment process.\n\ncoag_water &lt;- start_water %&gt;%\n  chemdose_ph(alum = 30) %&gt;%\n  chemdose_toc(alum = 30)\n\nfin_water &lt;- coag_water %&gt;%\n  chemdose_ph(naocl = 4) %&gt;%\n  chemdose_dbp(cl2 = 2, time = 2, treatment = \"coag\")\n\nWarning in chemdose_dbp(., cl2 = 2, time = 2, treatment = \"coag\"): Temperature\nis outside the model bounds of temp=20 Celsius for coagulated water.\n\n\nWarning in chemdose_dbp(., cl2 = 2, time = 2, treatment = \"coag\"): pH is\noutside the model bounds of pH = 7.5 for coagulated water\n\nprint(paste(\"Coag DOC =\", round(coag_water@doc, 1), \"mg/L\"))\n\n[1] \"Coag DOC = 2.1 mg/L\"\n\nprint(paste(\"TTHM =\", round(fin_water@tthm), \"ug/L\"))\n\n[1] \"TTHM = 18 ug/L\"\n\n\nSo we can get some model outputs, but how does this tell us anything about our water? For that, we need to look at our historical data. We created some example data, but for a real analysis, this is when you would need to do data read-in and cleanup.\nThis first question we want to answer (to know if our water is “haunted”) is: Is my TOC hard to remove? By answering this question, we can understand the applicability of these empirical models and whether additional treatment (such as pre-ozone) would help. To answer this question, we want to apply chemdose_toc to our historical data using the _chain family of functions. First, we’ll have to set up the columns, including a new UV column. Since we don’t have historical UV data, we can assume a SUVA and calculate UV.\nNote that we don’t use chemdose_ph in this case because we have the coagulation pH in our historical data. We’re also treating TOC and DOC as interchangable because they are usually close and DOC wasn’t measured.\n\ncolnames(hist_data)\n\n[1] \"raw_toc\"   \"fin_toc\"   \"coag_ph\"   \"fin_ph\"    \"cl2_dose\"  \"alum_dose\"\n[7] \"tthm\"     \n\ncoag_model &lt;- hist_data %&gt;%\n  # Creating new columns to feed into define_water_chain\n  mutate(doc = raw_toc,\n         ph = coag_ph,\n         alum = alum_dose) %&gt;%\n  mutate(suva_raw = 2,\n         uv254 = suva_raw / 100 * doc) %&gt;%\n  define_water_chain(\"precoag\") %&gt;%\n  chemdose_toc_chain(\"precoag\", \"coag\") %&gt;%\n  # Pull out parameters of interest\n  pluck_water(\"coag\", \"doc\")\n\nWarning: There were 36 warnings in `mutate()`.\nThe first warning was:\nℹ In argument: `precoag = furrr::future_pmap(., define_water)`.\nCaused by warning in `...furrr_fn()`:\n! Missing value for alkalinity. Carbonate balance will not be calculated.\nℹ Run `dplyr::last_dplyr_warnings()` to see the 35 remaining warnings.\n\n# Plot actual vs modeled coagulated DOC\n\nggplot(coag_model, aes(x = fin_toc, y = coag_doc)) +\n  geom_point() +\n  geom_abline() +\n  coord_cartesian(xlim = c(0, NA), ylim = c(0, NA)) +\n  theme_bw() +\n  labs(x = \"Actual TOC\", y = \"Modeled TOC\")\n\n\n\n\n\n\n\n\nIn a plot like this, anything above the 1:1 line means that the model is predicting “worse” removal than we are actually seeing and below the 1:1 line means that the model is predicting “better” removal. So if most of your data is below the line, your TOC is more recalcitrant to removal than the waters used to create the model - more “challenging” than a typical source water. If you are close to the line, you can use the model to get a pretty good prediction of coagulation performance.\nThe next question we want to ask is: Are there conditions that make my TOC easier or harder to remove?\n\n\n\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "sidestreams",
    "section": "",
    "text": "All Posts\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nMaking posts work\n\n\nfiddling around with ymls\n\n\n\nquarto_blog\n\n\n\n\n\n\n\n\n\nAug 25, 2024\n\n\nLibby McKenna\n\n\n\n\n\n\n\n\n\n\n\n\nThree ways to find out if your water is haunted…\n\n\n…by challenging organics\n\n\n\ntoc\n\n\ntreatment\n\n\n\n\n\n\n\n\n\nAug 25, 2024\n\n\nSierra Johnson\n\n\n\n\n\n\n\n\n\n\n\n\nWelcome To My Blog\n\n\n\n\n\n\nnews\n\n\n\n\n\n\n\n\n\nAug 22, 2024\n\n\nTristan O’Malley\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "About this site\n\n1 + 1\n\n[1] 2"
  },
  {
    "objectID": "posts/post-with-code/index.html",
    "href": "posts/post-with-code/index.html",
    "title": "Making posts work",
    "section": "",
    "text": "This is a post with executable code.\n\n\n\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "posts/index.html",
    "href": "posts/index.html",
    "title": "All Posts",
    "section": "",
    "text": "This should list all posts.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nThree ways to find out if your water is haunted…\n\n\n…by challenging organics\n\n\n\n\n\n\n\n\nAug 25, 2024\n\n\nSierra Johnson\n\n\n\n\n\n\n\n\n\n\n\n\nMaking posts work\n\n\nfiddling around with ymls\n\n\n\n\n\n\n\n\nAug 25, 2024\n\n\nLibby McKenna\n\n\n\n\n\n\n\n\n\n\n\n\nWelcome To My Blog\n\n\n\n\n\n\n\n\n\n\n\nAug 22, 2024\n\n\nTristan O’Malley\n\n\n\n\n\n\nNo matching items"
  }
]